
- [买单数据结构](#买单数据结构)
- [两种买单类型的区别](#两种买单类型的区别)
	- [1. FixForCollection（集合买单）](#1-fixforcollection集合买单)
	- [2. FixForItem（单品买单）](#2-fixforitem单品买单)
- [关键字段说明](#关键字段说明)


根据合约ABI和订单数据结构，我来展示Solidity中买单数据的结构：

## 买单数据结构

```solidity
struct Order {
    address collectionAddress;  // NFT集合合约地址
    uint256 tokenId;           // NFT的Token ID (FixForCollection时为0)
    bytes32 orderId;           // 订单唯一标识
    uint8 orderStatus;         // 订单状态
    uint256 eventTime;         // 订单创建时间
    uint256 expireTime;        // 订单过期时间
    address currencyAddress;   // 支付代币合约地址
    uint256 price;            // 出价
    address maker;            // 买家地址
    address taker;            // 接收方地址
    uint256 quantityRemaining; // 剩余可购买数量
    uint256 size;             // 订单大小
    uint8 orderType;          // 订单类型
    uint256 salt;             // 随机数
}
```

## 两种买单类型的区别

### 1. FixForCollection（集合买单）
```solidity
Order memory collectionBid = Order({
    collectionAddress: 0x...,
    tokenId: 0,  // 固定为0
    orderId: bytes32(...),
    orderStatus: 1,  // Active
    eventTime: block.timestamp,
    expireTime: block.timestamp + 86400,  // 24小时后过期
    currencyAddress: 0x...,  // 支付代币合约
    price: 0.1 ether,
    maker: 0x...,  // 买家地址
    taker: address(0),
    quantityRemaining: 1,
    size: 1,
    orderType: 3,  // CollectionBidOrder
    salt: uint256(keccak256(abi.encodePacked(block.timestamp, msg.sender)))
});
```

### 2. FixForItem（单品买单）
```solidity
Order memory itemBid = Order({
    collectionAddress: 0x...,
    tokenId: 123,  // 指定的Token ID
    orderId: bytes32(...),
    orderStatus: 1,  // Active
    eventTime: block.timestamp,
    expireTime: block.timestamp + 86400,  // 24小时后过期
    currencyAddress: 0x...,  // 支付代币合约
    price: 0.2 ether,
    maker: 0x...,  // 买家地址
    taker: address(0),
    quantityRemaining: 1,
    size: 1,
    orderType: 4,  // ItemBidOrder
    salt: uint256(keccak256(abi.encodePacked(block.timestamp, msg.sender)))
});
```

## 关键字段说明

1. `orderType`:
   - 3: CollectionBidOrder（集合买单）
   - 4: ItemBidOrder（单品买单）

2. `tokenId`:
   - FixForCollection: 必须为0
   - FixForItem: 指定具体的Token ID

3. `orderStatus`:
   - 1: Active（活跃状态）
   - 2: Filled（已成交）
   - 3: Cancelled（已取消）

4. `salt`:
   - 用于生成唯一订单ID
   - 建议使用时间戳和用户地址的组合

这些数据结构需要通过合约的`makeOrder`函数提交，并需要 maker 的签名验证。